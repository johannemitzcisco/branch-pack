<config-template xmlns="http://tail-f.com/ns/config/1.0">
  <devices xmlns="http://tail-f.com/ns/ncs">
  <device>
    <name>{$DEVICE-NAME}</name>
      <config>
        <hostname xmlns="urn:ios">{$DEVICE-NAME}</hostname>
        <aaa xmlns="urn:ios">
          <accounting>
            <delay-start>
            </delay-start>
          </accounting>
        </aaa>
        <ip xmlns="urn:ios">
          <source-route>true</source-route>
          <gratuitous-arps-conf>
            <gratuitous-arps>false</gratuitous-arps>
          </gratuitous-arps-conf>
          <finger>
          </finger>
          <tcp>
            <path-mtu-discovery>
            </path-mtu-discovery>
          </tcp>
          <http>
            <server>false</server>
            <secure-server>false</secure-server>
          </http>
          <as-path>
            <access-list>
              <name>1</name>
              <as-path-rule>
                <operation>permit</operation>
                <rule>^$</rule>
              </as-path-rule>
            </access-list>
          </as-path>
          <access-list>
            <extended>
              <ext-named-acl>
                <name>Branch_Office</name>
                <ext-access-list-rule>
                  <rule>remark Branch Office 2.0</rule>
                </ext-access-list-rule>
              </ext-named-acl>
            </extended>
          </access-list>
        </ip>
        <flow xmlns="urn:ios">
          <exporter>
            <name>AIG_Default</name>
            <description>AIG Default Netflow export to regional server</description>
            <destination>
              <address>{/branch[name=$SERVICE-NAME]/netflow-collector-ip-address}</address>
            </destination>
            <source>
              <Loopback>0</Loopback>
            </source>
            <transport>
              <udp>9995</udp>
            </transport>
          </exporter>
          <monitor>
            <name>AIG_Default_In_Monitor</name>
            <description>AIG Default Inbound/Ingress Netflow Monitor</description>
            <record>netflow ipv4 original-input</record>
            <exporter>
              <name>AIG_Default</name>
            </exporter>
            <cache>
              <timeout>
                <inactive>60</inactive>
                <active>60</active>
              </timeout>
            </cache>
          </monitor>
          <monitor>
            <name>AIG_Default_Out_Monitor</name>
            <description>AIG Default Outbound/Egress Netflow Monitor</description>
            <record>netflow ipv4 original-output</record>
            <exporter>
              <name>AIG_Default</name>
            </exporter>
            <cache>
              <timeout>
                <inactive>60</inactive>
                <active>60</active>
              </timeout>
            </cache>
          </monitor>
        </flow>
        <interface xmlns="urn:ios">
          <Loopback>
            <name>0</name>
            <description>branch:wan:&lt;site address></description>
            <ip>
              <address>
                <primary>
                  <address>{/branch[name=$SERVICE-NAME]/topology/device[name=$DEVICE-NAME]/loopback-ip-address}</address>
                  <mask>255.255.255.255</mask>
                </primary>
              </address>
            </ip>
          </Loopback>
          <GigabitEthernet foreach="{/branch[name=$SERVICE-NAME]/topology/connection/endpoint[device = $DEVICE-NAME and interface-type = 'GigabitEthernet']}">
            <name>{current()/interface-name}</name>
            <description>description goes here</description>
            <!-- bfd>
              <interval>
                <msecs>{/branch-policies/interface/bfd-interval[name=/branch[name=$SERVICE-NAME]/topology/connection/endpoint[device = $DEVICE-NAME and interface-type = 'GigabitEthernet']/bfd-interval]/msecs}</msecs>
                <min_rx>500</min_rx>
                <multiplier>3</multiplier>
              </interval>
            </bfd -->
            <!-- bandwidth>
              <kilobits>500</kilobits>
            </bandwidth -->
            <dampening>
            </dampening>
            <ip>
              <address>
                <primary>
                  <!-- address>{/branch[name=$SERVICE-NAME]/topology/connection/endpoint[device = $DEVICE-NAME and interface-type = 'GigabitEthernet']/ip-address}</address>
                  <mask>{/branch[name=$SERVICE-NAME]/topology/connection/endpoint[device = $DEVICE-NAME and interface-type = 'GigabitEthernet']/ip-mask}</mask -->
                  <address>{current()/ip-address}</address>
                  <mask>{current()/ip-mask}</mask>
                </primary>
              </address>
              <!-- flow>
                <monitor>
                  <direction>input</direction>
                  <name>AIG_Default_In_Monitor</name>
                </monitor>
                <monitor>
                  <direction>output</direction>
                  <name>AIG_Default_Out_Monitor</name>
                </monitor>
              </flow -->
            </ip>
            <load-interval>30</load-interval>
          </GigabitEthernet>
          <!-- GigabitEthernet>
            <name>0/0/1</name>
            <description>&lt;description></description>
            <dampening>
            </dampening>
            <ip>
              <address>
                <primary>
                  <address>3.3.3.3</address>
                  <mask>255.255.255.254</mask>
                </primary>
              </address>
              <ospf>
                <network>point-to-point</network>
                <cost>10</cost>
              </ospf>
            </ip>
            <load-interval>30</load-interval>
          </GigabitEthernet -->
          <!-- GigabitEthernet>
            <name>0/0/2</name>
            <description>&lt;description></description>
            <dampening>
            </dampening>
            <ip>
              <address>
                <primary>
                  <address>4.4.4.4</address>
                  <mask>255.255.255.254</mask>
                </primary>
              </address>
              <ospf>
                <network>point-to-point</network>
                <cost>10</cost>
              </ospf>
            </ip>
            <load-interval>30</load-interval>
          </GigabitEthernet>
          <GigabitEthernet>
            <name>0/0/3</name>
            <description>L3: &lt;remote_router>:&lt;port></description>
            <bfd>
              <interval>
                <msecs>500</msecs>
                <min_rx>500</min_rx>
                <multiplier>3</multiplier>
              </interval>
            </bfd>
            <dampening>
            </dampening>
            <ip>
              <address>
                <primary>
                  <address>5.5.5.5</address>
                  <mask>255.255.255.254</mask>
                </primary>
              </address>
              <ospf>
                <bfd>
                </bfd>
              </ospf>
            </ip>
            <load-interval>30</load-interval>
          </GigabitEthernet>
          <GigabitEthernet>
            <name>0/0/4</name>
            <description>L3: &lt;remote_router>:&lt;port></description>
            <bfd>
              <interval>
                <msecs>500</msecs>
                <min_rx>500</min_rx>
                <multiplier>3</multiplier>
              </interval>
            </bfd>
            <dampening>
            </dampening>
            <ip>
              <address>
                <primary>
                  <address>6.6.6.6</address>
                  <mask>255.255.255.254</mask>
                </primary>
              </address>
              <ospf>
                <bfd>
                </bfd>
              </ospf>
            </ip>
            <load-interval>30</load-interval>
          </GigabitEthernet>
          <GigabitEthernet>
            <name>0/1</name>
            <ip>
              <no-address>
                <address>false</address>
              </no-address>
            </ip>
          </GigabitEthernet-->
        </interface>
        <!-- route-map xmlns="urn:ios">
          <name>EBGP_OUT</name>
          <sequence>10</sequence>
          <operation>permit</operation>
          <match>
            <as-path>1</as-path>
          </match>
        </route-map>
        <router xmlns="urn:ios">
          <bgp>
            <as-no>200</as-no>
            <bgp>
              <router-id>2.2.2.2</router-id>
              <log-neighbor-changes>true</log-neighbor-changes>
              <update-delay>1</update-delay>
            </bgp>
            <network>
              <number>8.8.8.8</number>
              <mask>255.255.255.254</mask>
            </network>
            <aggregate-address>
              <address>12.12.12.12</address>
              <mask>255.255.255.0</mask>
              <summary-only/>
            </aggregate-address>
            <neighbor-tag>
              <neighbor>
                <id>BRANCH_IBGP</id>
                <peer-group/>
                <remote-as>300</remote-as>
                <fall-over-bfd>
                  <fall-over>
                    <bfd/>
                  </fall-over>
                </fall-over-bfd>
                <next-hop-self/>
                <soft-reconfiguration>inbound</soft-reconfiguration>
              </neighbor>
            </neighbor-tag>
            <neighbor>
              <id>9.9.9.9</id>
              <peer-group>BRANCH_IBGP</peer-group>
              <update-source>
                <GigabitEthernet>0/1/0</GigabitEthernet>
              </update-source>
              <description>branch:ibgp:&lt;peer_router></description>
            </neighbor>
            <neighbor>
              <id>10.10.10.10</id>
              <peer-group>BRANCH_IBGP</peer-group>
              <update-source>
                <GigabitEthernet>0/1/1</GigabitEthernet>
              </update-source>
              <description>branch:ibgp:&lt;peer_router></description>
            </neighbor>
            <neighbor>
              <id>11.11.11.11</id>
              <remote-as>400</remote-as>
              <timers>
                <keepalive-interval>2</keepalive-interval>
                <holdtime>8</holdtime>
              </timers>
              <fall-over-bfd>
                <fall-over>
                  <bfd/>
                </fall-over>
              </fall-over-bfd>
              <send-community>
              </send-community>
              <soft-reconfiguration>inbound</soft-reconfiguration>
              <route-map>
                <direction>out</direction>
                <route-map-name>EBGP_OUT</route-map-name>
              </route-map>
              <description>branch:ebgp:&lt;Carrier_Name></description>
            </neighbor>
            <auto-summary>false</auto-summary>
          </bgp>
          <ospf>
            <id>1</id>
            <log-adjacency-changes>
            </log-adjacency-changes>
            <passive-interface>
              <interface>
                <name>Gig0/0/0</name>
              </interface>
            </passive-interface>
            <router-id>2.2.2.2</router-id>
            <default-information>
              <originate>
                <metric>10</metric>
              </originate>
            </default-information>
            <network>
              <ip>2.2.2.2</ip>
              <mask>0.0.0.0</mask>
              <area>0</area>
            </network>
            <network>
              <ip>3.3.3.3</ip>
              <mask>0.0.0.0</mask>
              <area>0</area>
            </network>
            <network>
              <ip>4.4.4.4</ip>
              <mask>0.0.0.0</mask>
              <area>0</area>
            </network>
            <network>
              <ip>5.5.5.5</ip>
              <mask>0.0.0.0</mask>
              <area>0</area>
            </network>
            <network>
              <ip>6.6.6.6</ip>
              <mask>0.0.0.0</mask>
              <area>0</area>
            </network>
          </ospf>
        </router -->
      </config>
  </device>
  </devices>
</config-template>
